# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.
image:
  file: .gitpod.dockerfile

vscode:
  extensions:
    - svelte.svelte-vscode
    - Prisma.prisma

tasks:
  # Init S3 access
  - init: |
      sudo apt install -y rclone
      mkdir -p ~/.config/rclone/
      cp configs/rclone.conf ~/.config/rclone/rclone.conf
      gp sync-done configs-done

  - init: |
      npm install
      gp sync-done install-done

  - name: Database
    init: |
      gp sync-await install-done
      gp sync-await configs-done
      npx prisma migrate reset --force
      gp sync-done db-done

  - name: Server
    init: |
      gp sync-await install-done
      gp sync-await db-done
    command: npm run dev

  - name: Prisma studio
    init: |
      gp sync-await db-done
    command: npx prisma studio
